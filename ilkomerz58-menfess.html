<!DOCTYPE HTML>
<html>
	<head>
		<title>Ilkomerz58 Menfess</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
		<link rel="stylesheet" href="assets\css\stackoverflow-dark.min.css">
	</head>
	<body class="is-preload">
		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<div class="inner">

							<!-- Logo -->
								<a href="index.html" class="logo">
									<span class="title">Home</span>
								</a>

					</header>

				<!-- Main -->
					<div id="main">
						<div class="inner">
							<h1>Ilkomerz58 Menfess</h1>
							<a href="https://github.com/irfanalmsyah/Ilkomerz58-Menfess" target="_blank" class="button primary" style="margin-bottom: 0.5em;">Github Repository</a>
							<h2>Description</h2>
							<p>This project is a Discord.py Bot that was made to forward your direct message to the bot to your specified channel in a server. The bot itself uses repl.it as a server to run</p>
							<h2>Code Breakdown</h2>
							<pre><code class="language-python">
import discord
from discord.ext import commands, tasks
import io
import os
from itertools import cycle
from dotenv import load_dotenv
from keep_alive import keep_alive
							</code></pre>
							<p>These lines of code import packages and modules required. <code>discord</code> and <code>discord.ext</code> is API wrapper for discord. It's basically essential for this project.<code>io</code> is required to sending attachment (images, videos, etc). <code>os</code> and <code>dotenv</code> is required to take credential from <code>.env</code> file. <code> itertools</code> is required to make the discord bot presence changing periodically. <code>keep_alive</code> is required for repl.it so the bot is always running</p>
							<pre><code class="language-python">
load_dotenv()
client = commands.Bot(command_prefix='.')
client.remove_command('help')
channel_id = int(os.getenv("CHANNEL_ID"))
status = cycle (["by @sooji & @kuntuy", "DM to send a menfess"])
							</code></pre>
							<p>The first line runs function to loads credential from <code>.env</code> file. The next line instantiate the bot. The next 4 line is pretty much self-explanatory</p>
							<pre><code class="language-python">
@client.event
async def on_ready():
	print('{0.user} is on'.format(client))
	change_status.start()
							</code></pre>
							<p>These lines of code prints the bot name and discriminator and runs a function to change the bot activity presence</p>
							<pre><code class="language-python">
@tasks.loop(seconds=10)
async def change_status():
	await client.change_presence(activity=discord.Game(next(status)))

async def pull_attachment(attachment):
    file = io.BytesIO()
    await attachment.save(file)
    return discord.File(file, filename=attachment.filename)

async def pull_files(abc):
    if len(abc) < 1:
        return
    elif len(abc) > 0:
        files = [await pull_attachment(attachment) for attachment in abc]
        return files
							</code></pre>
							<p>These lines of code defines a function to change the bot activity presence, a function to pull attachment and file from user</p>

							<pre><code class="language-python">
@client.command()
async def ping(ctx):
  await ctx.send('pong')
							</code></pre>
							<p>These lines of code defines a function to send <code>pong</code> when the user send <code>.ping</code></p>

							<pre><code class="language-python">
@client.command()
async def ct(ctx):
    if ctx.message.guild != None:
        return
    channel1 = client.get_channel(channel_id)
    archived_threads = channel1.archived_threads()
    archived_threads = await archived_threads.flatten()
    index = int(len(channel1.threads) + len(archived_threads)+ 1)
    if index < 10:
        index = "00" + str(index)
    elif index >= 10 and index <100:
        index = "0" + str(index)
    message_content = str(ctx.message.content)
    del1 = message_content.replace(f".{str(ctx.command.name)} ", "", 1)
    sent_message = f"__**{index}**__: {del1}"
    thread_name = f"{index}: {del1}"
    files = await pull_files(ctx.message.attachments)
    message = await channel1.send(sent_message, files=files)
    await message.create_thread(name = thread_name)
							</code></pre>
							<p>These lines of code defines a function to create a thread when the user send <code>.ct [message]</code></p>
							<pre><code class="language-python">
@client.command()
async def rt(ctx, index):
    if ctx.message.guild != None:
        return
    elif len(index) != 3:
        await ctx.send("index format incorrect")
        return
    channel1 = client.get_channel(channel_id)
    archived_threads = channel1.archived_threads()
    archived_threads = await archived_threads.flatten()
    thread_id = [thread.id for thread in channel1.threads if thread.name.startswith(str(index))] + [thread.id for thread in archived_threads if thread.name.startswith(str(index))]
    if len(thread_id) < 1:
        await ctx.channel.send("Thread not found")
    elif len(thread_id) > 0:
        thread = await client.fetch_channel(int(thread_id[0]))
        message_content = str(ctx.message.content)
        del1 = message_content.replace(f".{str(ctx.command.name)} ", "", 1)
        del2 = del1.replace(f"{str(index)} ", "", 1)
        files = await pull_files(ctx.message.attachments)
        await thread.send(del2, files=files)
							</code></pre>
							<p>These lines of code defines a function to reply to a thread when the user send <code>.rt [threadindex] [message]</code></p>

							<pre><code class="language-python">
@client.command()
async def m(ctx):
    if ctx.message.guild != None:
        return
    channel1 = client.get_channel(channel_id)
    message_content = str(ctx.message.content)
    del1 = message_content.replace(f".{str(ctx.command.name)} ", "", 1)
    files = await pull_files(ctx.message.attachments)
    msg = await channel1.send('**Menfess:** '+del1, files=files)
    await msg.add_reaction('❤️')
							</code></pre>
							<p>These lines of code defines a function to send a message when the user send <code>.m [message]</code></p>
							<pre><code class="language-python">
@client.command()
async def tampol(ctx, member:discord.User=None):
  if (member == ctx.message.author or member == None):
      await ctx.send(f"{ctx.message.author.mention} menampol diri sendiri!") 
  else:
      await ctx.send(f"{ctx.message.author.mention} menampol {member.mention}!")  
							</code></pre>
							<p>These lines of code defines a function to send a <code>[message author] tampol [user]</code> when the user send <code>.tampol [user]</code></p>

							<pre><code class="language-python">
@client.command()
async def github(ctx):
  await ctx.send('https://github.com/irfanalmsyah/Ilkomerz58-Menfess')
  await ctx.send('https://replit.com/@irfanalmsyah/Ilkomerz58-Menfess')  
							</code></pre>
							<p>These lines of code defines a function to send link to this bot repository when the user send <code>.github</code></p>

							<pre><code class="language-python">
@client.command()
async def gangerti(ctx):
  await ctx.send("""
.m <text> | bikin menfess tanpa thread
.ct <judul thread> | bikin menfess pake thread
.rt <thread index> <text> | reply ke thread pakai bot
.tampol <user> | tampol
.github | show the bot github repository
  """) 
							</code></pre>
							<p>These lines of code defines a function to send help message when the user send <code>.gangerti</code></p>
							<pre><code class="language-python">
keep_alive()  
client.run (os.getenv("TOKEN"))
							</code></pre>
							<p>This runs <code>keep_alive()</code>function and the bot</p>
						</div>

					</div>

				<!-- Footer -->
				<footer id="footer">
					<div class="inner">
						<section>
							<h2>About Me</h2>
							<p>Hi! My name is Irfan Alamsyah. I'm a computer science freshman in IPB University. I'm currently learning Python, Javascript, and C. I have interest in cyber security, bots, and web development.  </p>
						</section>
						<section>
							<h2>Contact</h2>
							<ul class="icons">
								<li><a href="https://github.com/irfanalmsyah" target="_blank" class="icon brands style2 fa-github"><span class="label">GitHub</span></a></li>
								<li><a href="https://twitter.com/_irfanalamsyah" target="_blank" class="icon brands style2 fa-twitter"><span class="label">Twitter</span></a></li>
								<li><a href="https://www.instagram.com/_irfanalamsyah" target="_blank" class="icon brands style2 fa-instagram"><span class="label">Instagram</span></a></li>
								<li><a onclick="discordCopy()" target="_blank" class="icon brands style2 fa-discord"><span class="label">Discord</span></a></li>
								<li><a href="https://www.reddit.com/user/ipan26/" target="_blank" class="icon brands style2 fa-reddit"><span class="label">Reddit</span></a></li>
								<li><a href="http://line.me/ti/p/~irfanalamsyaah" target="_blank" class="icon brands style2 fa-line"><span class="label">Line</span></a></li>
								<li><a href="http://t.me/irfanalmsyah" target="_blank" class="icon brands style2 fa-telegram"><span class="label">Telegram</span></a></li>
							</ul>
						</section>
						<ul class="copyright">
							<li>&copy; All rights reserved</li>
						</ul>
					</div>
				</footer>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
			<script src="assets\js\highlight.min.js"></script>
			<script>hljs.highlightAll();</script>
	</body>
</html>